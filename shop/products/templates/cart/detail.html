{% extends "__base.html" %}

{% block title %}My Cart{% endblock %}

{% block content %}
<div class="container mt-5">
  <h1 class="mb-4 text-center">üõí My Cart</h1>

  {% if cart.items.all %}
    <div class="row g-4">
      {% for item in cart.items.all %}
      <div class="col-md-6 col-lg-4">
        <div class="card shadow-sm h-100">
          <div class="card-body d-flex flex-column justify-content-between">
            <div>
              <h5 class="card-title fw-bold">{{ item.product.name }}</h5>
              <p class="card-text mb-1">Price: <span class="text-success fw-semibold">${{ item.product.price }}</span></p>
              <p class="card-text mb-3">Total: <span class="fw-bold">${{ item.total_price }}</span></p>
            </div>

            <div class="d-flex align-items-center justify-content-between mb-3">
              <div class="d-flex align-items-center gap-1">
                <form method="post" action="{% url 'products:cart_update' item.id %}">
                  {% csrf_token %}
                  <button type="submit" name="action" value="decrease" class="btn btn-outline-secondary btn-sm">‚ûñ</button>
                </form>

                <form method="post" action="{% url 'products:cart_update' item.id %}">
                  {% csrf_token %}
                  <input type="text" name="quantity" value="{{ item.quantity }}" class="form-control text-center" style="width: 50px;">
                </form>

                <form method="post" action="{% url 'products:cart_update' item.id %}">
                  {% csrf_token %}
                  <button type="submit" name="action" value="increase" class="btn btn-outline-secondary btn-sm">‚ûï</button>
                </form>
              </div>

              <a href="{% url 'products:cart_remove' item.id %}" class="btn btn-danger btn-sm">‚ùå Remove</a>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>

    <div class="d-flex justify-content-end mt-4 align-items-center gap-3">
      <h4 class="fw-bold mb-0">Total: <span class="text-success">${{ cart.total_price }}</span></h4>
      <a href="{% url 'products:checkout' %}" class="btn btn-success btn-lg rounded-pill px-4">‚úÖ Checkout</a>
    </div>


  {% else %}
    <div class="alert alert-info rounded shadow p-4 text-center">
      Your cart is empty. üõçÔ∏è  
      <a href="{% url 'products:index' %}" class="alert-link">Go shopping</a>
    </div>
  {% endif %}

  <div class="mt-4 text-center">
    <a href="{% url 'products:index' %}" class="btn btn-outline-dark">‚¨Ö Back to products</a>
  </div>
</div>
{% endblock %}
